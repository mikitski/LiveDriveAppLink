<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <style>
      .center-div {

		width:100%
          height: 80%;
      }
      .wheelGray {
        fill: rgba(241, 241, 241, .78);
      }
      .wheelBlue {
        fill: rgba(85, 138, 208, 0.78);
      }
      .wheelGreen {
        fill: rgba(0, 156, 26, 0.78);
      }
      .wheelRed {
        fill: rgba(205, 32, 39, 0.78);
      }
      .wheelOuterGreen {
        fill: rgba(64, 194, 0, 0.78);
      }
      #blueEmptyCircle {
        fill: rgb(255,255,255);
        stroke: rgba(85, 138, 208, 0.78);
        stroke-width: 2px;
      }
      #redEmptyCircle {
        fill: rgb(255,255,255);
        stroke: rgba(205, 32, 39, 0.78);
        stroke-width: 2px;
      }
      #greenEmptyCircle {
        fill: rgb(255,255,255);
        stroke: rgba(0, 156, 26, 0.78);
        stroke-width: 2px;
      }
      @font-face {
        font-family: 'OpenSans';
        src: url("OpenSans-Regular.ttf") format("truetype");
      }
      text.textRed {
        font-family: OpenSans;
        font-size: 212.5px;
        font-weight: 400;
        fill: rgba(205, 32, 39, 0.78);
      }
      text.textGreen {
        font-family: OpenSans;
        font-size: 212.5px;
        font-weight: 400;
        fill: rgba(0, 156, 26, 0.78);
      }
      text.markerText {
        font-family: OpenSans;
        font-size: 34px;
        font-weight: 600;
        fill: rgb(255, 255, 255);
      }
      text.textDriverScore {
        font-family: OpenSans;
        font-size: 34px;
        font-weight: 600;
      }
      div.padding {
        padding-bottom: 100px;
      }
	
	.swiper-container, .swiper-slide {
	  width: 100%;
	  height: 900px;
	}
	
	.swiper-pager{
		position:absolute;
		left:0;
		text-align:center;

		width:100%;
	}
	.swiper-pagination-switch{
		display:inline-block;
		width:25px;
		height:25px;
		border-radius:25px;
		background:#999;
		box-shadow:0px 2px 4px #555 inset;
		margin:0 25px;
		cursor:pointer;
	}
	.swiper-active-switch{
		background:#fff;
	}
	
	svg{
		display:block;
		// margin:auto;
		margin-left:150px;
	}
      
    </style>
    <script src="d3.min.js"></script>
    <script type="text/javascript" src="./jquery.min.js"></script>
	<link rel="stylesheet" href="idangerous.swiper.css">
	<script type="text/javascript" defer src="./idangerous.swiper.js"></script>

    
  </head>
  <body>
    <div class="padding">
    </div>
<div class="wrapper">
<div class="swiper-container">
  <div class="swiper-wrapper">
              <div id="driver_score" class="center-div swiper-slide">
              </div>
              <div id="mpg_score" class="center-div swiper-slide">
              </div>
              <div id="driver_leaderboard" class="center-div swiper-slide">
					<h1>Placeholder: driver leaderboard</h1>
              </div>
              <div id="mpg_leaderboard" class="center-div swiper-slide">
					<h1>Placeholder: mpg leaderboard</h1>
              </div>
	</div>
	</div>
	<div class="swiper-pager"></div>
	
</div>
    <script>

function placeOnCircle(centerX, centerY, radius, angleRadians) {
  var x = centerX - (radius * Math.sin(angleRadians));
  var y = centerY + (radius * Math.cos(angleRadians));
  return { x: x, y: y };
}

function genericScore(innerScore, outerScore, rank, divName, bottomSVG, text, outerWheelCSS, markerSVG) {
  var driverScore = document.getElementById(divName);
  var didScoreGoDown = outerScore - innerScore > 0;

  d3.select(driverScore).select("svg").remove();
  var svg = d3.select(driverScore).append("svg")
              .attr("width", 860).attr("height", 860);

  svg.append("image")
      .attr("xlink:href", "MeterRing.svg")
      .attr("width", "720").attr("height", "720")
      .attr("x", 21).attr("y", 121);

  var data = [outerScore, (100-outerScore)];
  var pie = d3.layout.pie();
  pie.startAngle(0);
  pie.endAngle(2*Math.PI - (Math.PI/3));
  var pieResults = pie(data);

  var arc = d3.svg.arc();
  arc.innerRadius(function(d) { return 308; });
  arc.outerRadius(function(d) { return 380; });
  d3.select(driverScore).select("svg").selectAll("g.arc")
    .data(pieResults)
    .enter()
    .append("g").attr("class", "arc").attr("transform", "translate(380, 480) rotate(210)")
    .append("path")
    .classed(outerWheelCSS, function(d,i) { if (i == 0) { return true; } })
    .classed("wheelGray", function(d,i) { if (i != 0) { return true; } })
    .attr("d", arc);

  var blueEmptyPos = placeOnCircle(380, 480, 345, pieResults[0].endAngle + Math.PI / 6);
  svg.append("circle").attr("r", "36").attr("transform", "translate("+ blueEmptyPos.x +","+ blueEmptyPos.y +")").attr("id", "blueEmptyCircle");

  svg.append("image")
     .attr("xlink:href", markerSVG)
     .attr("width", "128").attr("height", "120")
     .attr("x", blueEmptyPos.x).attr("y", blueEmptyPos.y - 120);
  svg.append("text").classed("markerText", true).attr("transform", "translate("+(blueEmptyPos.x+60)+","+(blueEmptyPos.y-70)+") scale(1.399,1.398)").text(outerScore);

  var data2 = [innerScore, (100-innerScore)];
  var pieResults2 = pie(data2);
  var arcInner = d3.svg.arc();
  arcInner.innerRadius(function(d) { return 243; });
  arcInner.outerRadius(function(d) { return 300; });

  d3.select(driverScore).select("svg").selectAll("g.arcInner")
    .data(pieResults2)
    .enter()
    .append("g").attr("class", "arcInner").attr("transform", "translate(381, 481) rotate(210)")
    .append("path")
    .classed("wheelGreen", function(d,i) { if (i == 0 && !didScoreGoDown) { return true; } })
    .classed("wheelRed", function(d,i) { if (i == 0 && didScoreGoDown) { return true; } })
    .classed("wheelGray", function(d,i) { if (i != 0) { return true; } })
    .attr("d", arcInner);

  var innerEmptyPos = placeOnCircle(381, 481, 272, pieResults2[0].endAngle + Math.PI / 6);
  svg.append("circle").attr("r", "29").attr("transform", "translate("+ innerEmptyPos.x +","+ innerEmptyPos.y +")").attr("id", didScoreGoDown?"redEmptyCircle":"greenEmptyCircle");

  d3.select(driverScore).select("svg").append("text")
  .attr("transform", "translate(220,570) scale(1.399, 1.398)").text(innerScore).classed(didScoreGoDown?"textRed":"textGreen", true);

  d3.select(driverScore).select("svg").append("text")
  	//.attr("transform", "translate(249,630) scale(1.399, 1.398)")
    .attr("transform", "translate(391,630) scale(1.399, 1.398)")
  	.attr("text-anchor", "middle")  
	.text(text).classed("textDriverScore", true);
  

  svg.append("image")
     .attr("xlink:href", bottomSVG)
     .attr("width", "220").attr("height", "280")
     .attr("x", 293).attr("y", 613);

     

  d3.select(driverScore).select("svg").append("text")
  .attr("transform", "translate(442,815)").text(rank).attr("style", "font-family:Arial; font-size: 43px;");

}

function drawDriverScore(innerScore, outerScore, rank) {
  genericScore(innerScore, outerScore, rank, "driver_score", "Driver_Marker 1.svg", "Driver Score", "wheelBlue", "Driver_Marker.svg");
}

function drawMpgScore(innerScore, outerScore, rank) {
  genericScore(innerScore, outerScore, rank, "mpg_score", "Fuel Icon 1.svg", "Eco Score", "wheelOuterGreen", "MPG_Marker.svg");
}

window.onload = function() {
  var mySwiper = new Swiper('.swiper-container',{
    //Your options here:
    mode:'horizontal',
    loop: true,
    pagination: '.swiper-pager',
    paginationClickable: true
    //etc..
  });  
}

 drawDriverScore(80, 80, 10);
 drawMpgScore(60, 70, 23);
    </script>
  </body>
</html>
