<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <style>
      .center-div {
      	  margin-top:auto;
      	  margin-right:auto;
      	  margin-botton:auto;
      	  margin-left:67px;
          width: 80%;
          height: 80%;
      }
      .wheelBlue {
        fill: rgba(85, 138, 208, 0.78);
      }
      .wheelGreen {
        fill: rgba(0, 156, 26, 0.78);
      }
      .wheelRed {
        fill: rgba(205, 32, 39, 0.78);
      }
      @font-face {
        font-family: 'OpenSans';
        src: url("OpenSans-Regular.ttf") format("truetype");
      }
      text.textRed {
        font-family: OpenSans; 
        font-size: 270px; 
        fill: rgba(205, 32, 39, 0.78);
      }
      text.textGreen {
        font-family: OpenSans; 
        font-size: 270px; 
        fill: rgba(0, 156, 26, 0.78);
      }
    </style>
    <link rel="stylesheet" type="text/css" href="./jcarousel.responsive.css">
    <script src="d3.min.js"></script>
    <script type="text/javascript" src="./jquery.min.js"></script>
    <script type="text/javascript" src="./jquery.jcarousel.min.js"></script>
    <script type="text/javascript" src="./jcarousel.responsive.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <div class="jcarousel-wrapper">
        <div class="jcarousel">
          <ul>
            <li>
              <div id="driver_score" class="center-div">
              </div>
            </li>
            <li>
              <div id="mpg_score" class="center-div">
              </div>
            </li>
            <li>
              <div id="driver_leaderboard" class="center-div">
		<h1>Placeholder: driver leaderboard</h1>
              </div>
            </li>
            <li>
              <div id="mpg_leaderboard" class="center-div">
		<h1>Placeholder: mpg leaderboard</h1>
              </div>
            </li>
            </ul>
          </div>
          <a href="#" class="jcarousel-control-prev">&lsaquo;</a>
          <a href="#" class="jcarousel-control-next">&rsaquo;</a>
        <p class="jcarousel-pagination"></p>
      </div>
    </div>       
    <script>

function drawDriverScore(innerScore, outerScore, rank) {     
  var driverScoreDiv = document.getElementById("driver_score");
  console.log(driverScoreDiv);
      
  var didScoreGoDown = outerScore - innerScore > 0;

  d3.select(driverScoreDiv).select("svg").remove();
  var svg = d3.select(driverScoreDiv).append("svg")
              .attr("width", 760).attr("height", 760);
      
  svg.append("image")
      .attr("xlink:href", "MeterRing.svg")
      .attr("width", "720").attr("height", "720")
      .attr("x", 21).attr("y", 21);
      
  var data = [outerScore, (100-outerScore)];
  var pie = d3.layout.pie();
  pie.startAngle(0);
  pie.endAngle(2*Math.PI - (Math.PI/3));
  var pieResults = pie(data);
      
  var arc = d3.svg.arc();
  arc.innerRadius(function(d) { return 311; });
  arc.outerRadius(function(d) { return 380; });
  console.log(arc(pieResults[0]));
      
  // blue = rgba(85, 138, 208, 0.78)
  d3.select(driverScoreDiv).select("svg").selectAll("g.arc")
    .data(pieResults)
    .enter()
    .append("g").attr("class", "arc").attr("transform", "translate(382, 380) rotate(210)")
    .append("path")
    .attr("fill", function(d,i) 
      {  
        if (i == 0) { return d3.rgb(85, 138, 208).toString(); }
        return d3.rgb(199,199,199).toString();
      })
    .attr("d", arc);

  var data2 = [innerScore, (100-innerScore)];
  var pieResults2 = pie(data2);
  var arcInner = d3.svg.arc();
  arcInner.innerRadius(function(d) { return 243; });
  arcInner.outerRadius(function(d) { return 300; });
      
  // green = rgba(0, 156, 26, 0.78)
  d3.select(driverScoreDiv).select("svg").selectAll("g.arcInner")
    .data(pieResults2)
    .enter()
    .append("g").attr("class", "arcInner").attr("transform", "translate(381, 381) rotate(210)")
    .append("path")
    .attr("fill", function(d,i) 
      {  
        if (i == 0) { 
	  if (didScoreGoDown) {	
	    return d3.rgb(255, 0, 0).toString();	    
	  }
          else {
	    return d3.rgb(0, 156, 26).toString();					 
          }
	}
        return d3.rgb(199,199,199).toString();
      })
    .attr("d", arcInner);
      
  d3.select(driverScoreDiv).select("svg").append("text").attr("transform", "translate(240,470)").text(innerScore).classed(didScoreGoDown?"textRed":"textGreen", true);
  d3.select(driverScoreDiv).select("svg").append("text").attr("transform", "translate(263,530)").text("Driver Score").attr("style", "font-family:Arial; font-size: 44px");
      
  svg.append("image")
     .attr("xlink:href", "Driver_Marker 1.svg")
     .attr("width", "220").attr("height", "280")
     .attr("x", 293).attr("y", 513);

  d3.select(driverScoreDiv).select("svg").append("text").attr("transform", "translate(442,715)").text(rank).attr("style", "font-family:Arial; font-size: 43px;");
}
      
      
      
      function drawMpgScore(innerScore, outerScore) {
      
      var mpgScoreDiv = document.getElementById("mpg_score");
      console.log(mpgScoreDiv);
      
      d3.select(mpgScoreDiv).select("svg").remove();
      var svg = d3.select(mpgScoreDiv).append("svg").attr("width", 760).attr("height", 760);
      
      svg.append("image").attr("xlink:href", "MeterRing.svg").attr("width", "720").attr("height", "720").attr("x", 24).attr("y", 24);
      
      var data = [outerScore, (100-outerScore)];
      var pie = d3.layout.pie();
      pie.startAngle(0);
      pie.endAngle(2*Math.PI - (Math.PI/3));
      var pieResults = pie(data);
      
      // 70, 4, 57
      // view creative cloud for exact dimensions
      
      
      var arc = d3.svg.arc();
      arc.innerRadius(function(d) { return 310; });
      arc.outerRadius(function(d) { return 380; });
      console.log(arc(pieResults[0]));
      
      // blue = rgba(85, 138, 208, 0.78)
      d3.select(mpgScoreDiv).select("svg").selectAll("g.arc")
      .data(pieResults)
      .enter()
      .append("g").attr("class", "arc").attr("transform", "translate(380, 380) rotate(210)")
      .append("path")
      .attr("fill", function(d,i) 
      {  
      if (i == 0) { return d3.rgb(85, 138, 208).toString() }
      return d3.rgb(199,199,199).toString();
      })
      .attr("d", arc);
      
      
      var data2 = [innerScore, (100-innerScore)];
      var pieResults2 = pie(data2);
      var arcInner = d3.svg.arc();
      arcInner.innerRadius(function(d) { return 182; });
      arcInner.outerRadius(function(d) { return 220; });
      
      // green = rgba(0, 156, 26, 0.78)
      
      d3.select(mpgScoreDiv).select("svg").selectAll("g.arcInner")
      .data(pieResults2)
      .enter()
      .append("g").attr("class", "arcInner").attr("transform", "translate(272, 272) rotate(210)")
      .append("path")
      .attr("fill", function(d,i) 
      {  
      if (i == 0) { return d3.rgb(0, 156, 26).toString() }
      return d3.rgb(199,199,199).toString();
      })
      .attr("d", arcInner);
      
      
      d3.select(mpgScoreDiv).select("svg").append("text").attr("transform", "translate(155,342)").text(innerScore).attr("style", "font-family:Arial; font-size: 212px");
      d3.select(mpgScoreDiv).select("svg").append("text").attr("transform", "translate(176,392)").text("MPG Score").attr("style", "font-family:Arial; font-size: 34px");
      
      }      


      drawDriverScore(79, 76, 10);
      drawMpgScore(60, 70);
    </script>
  </body>
</html>
